2025. 12. 18.
src\engines\analysis\plotter.py

Onset Detection, Pitch Detection을 구현했다.
실제 기타에 물려서 사용해보니 다음과 같은 문제가 있었다.

1.  STFT의 nperseg의 영향인지 onset은 0, 512가 주로 찍힌다. 약 11.6ms 주기로 onset이 찍힌다. 약간 이상하지만 아주 짧은 시간이라 크게 문제는 안될거 같다.
2.  Onset이 threshold에 따라 다르게 잡힌다지만 줄 하나 튕겼을 때 긴 소리(반박 이상)에 대해 여러개의 onset이 찍힌다. 특히 저음일수록 그게 심하다. 
    그래서 음향학적 시간분해능을 쓰기보다 bpm과 subnote의 주기를 분해능의 최소단위로 잡거나 볼륨이 감쇠하는 특징을 이용해서 볼륨이 첫 onset보다 크지않으면 onset으로 인정안하는 방법을 쓰면 될 것 같다.
3.  Pitch의 경우 onset이 나왔을 때만 감지하게 했는데 감지율이 너무 떨어진다. threshold로 조정가능하나 번거롭다.
4.  5번줄 A튜닝 개방현으로 쳤을 때 A4(440Hz)가 잡혀야한다. 실제로는 A2(110Hz)가 포착된다. 모든 줄에 관해서 낮은 음의 배음이 우선적으로 잡혀버린다.

위의 사항들에 대해 다시 고민할 필요가 있다.